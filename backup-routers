from netmiko import ConnectHandler
newuser = open(r"C:\Users\user\Music\crednotepad.txt")
# Splitlines will covert into a list
creds = newuser.read().splitlines()
#print(creds)
# Multiple devices in the switches.txt used in the Dict
devices = open(r"C:\Users\user\Music\switches.txt")
switches = devices.read().splitlines()
# print(switches)
for IP in switches:
    CSR = {
            'device_type': 'cisco_ios',
            'ip': IP,
            'username': creds[0],
            'password': creds[1],
    }
    net_connect = ConnectHandler(**CSR)

    hostname = net_connect.send_command('show run | inc host')
    hostname.split(" ")
    print(hostname)
    print ("Backing up " + IP)
    filename = r'C:\Users\user\Music\BACKUP\ ' + IP + '.txt'
    # to save backup to same folder as script use below line and comment out above line
    # filename = device + '.txt'

    showrun = net_connect.send_command('show run')
    #print(showrun)
    showvlan = net_connect.send_command('show vlan')
    #print(showvlan)
    showver = net_connect.send_command('show ver')
    #print(showver)
    log_file = open(filename, "a")  # in append mode
    log_file.write(showrun)
    log_file.write("\n")
    log_file.write(showvlan)
    log_file.write("\n")
    log_file.write(showver)
    log_file.write("\n")

# Finally close the connection
net_connect.disconnect



    

    
